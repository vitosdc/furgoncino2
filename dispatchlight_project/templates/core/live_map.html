<!-- templates/core/live_map.html -->{% extends 'base.html' %}{% block title %}Mappa Live - DispatchLight{% endblock %}{% block content %}<div class="row">    <div class="col-12">        <div class="d-flex justify-content-between align-items-center mb-4">            <h1><i class="fas fa-map-marked-alt"></i> Mappa Live</h1>            <div>                <button class="btn btn-outline-primary" onclick="refreshMap()">                    <i class="fas fa-sync-alt"></i> Aggiorna                </button>                <button class="btn btn-outline-info" onclick="centerMap()">                    <i class="fas fa-crosshairs"></i> Centra                </button>            </div>        </div>    </div></div><div class="row">    <div class="col-lg-8">        <div class="card">            <div class="card-body p-0">                <div id="live-map" class="map-container">                    <!-- La mappa verrà caricata qui tramite JavaScript -->                    <div class="d-flex align-items-center justify-content-center h-100">                        <div class="text-center">                            <i class="fas fa-map fa-3x text-muted mb-3"></i>                            <h5 class="text-muted">Caricamento Mappa...</h5>                            <p class="text-muted">La mappa verrà implementata nella prossima fase</p>                        </div>                    </div>                </div>            </div>        </div>    </div>        <div class="col-lg-4">        <!-- Tecnici Online -->        <div class="card mb-4">            <div class="card-header">                <h5><i class="fas fa-users"></i> Tecnici Online</h5>            </div>            <div class="card-body">                {% if technicians %}                    {% for tech in technicians %}                    <div class="d-flex align-items-center mb-3 p-2 border rounded">                        <div class="flex-shrink-0">                            {% if tech.current_latitude and tech.current_longitude %}                                <i class="fas fa-circle text-success"></i>                            {% else %}                                <i class="fas fa-circle text-muted"></i>                            {% endif %}                        </div>                        <div class="flex-grow-1 ms-3">                            <h6 class="mb-1">{{ tech.user.get_full_name }}</h6>                            <small class="text-muted">                                {% if tech.last_location_update %}                                    Ultimo aggiornamento: {{ tech.last_location_update|timesince }} fa                                {% else %}                                    Posizione non disponibile                                {% endif %}                            </small>                        </div>                    </div>                    {% endfor %}                {% else %}                    <div class="text-center py-3">                        <i class="fas fa-user-slash fa-2x text-muted mb-2"></i>                        <p class="text-muted">Nessun tecnico attivo</p>                    </div>                {% endif %}            </div>        </div>                <!-- Ordini Pendenti -->        <div class="card">            <div class="card-header">                <h5><i class="fas fa-clock"></i> Ordini da Assegnare</h5>            </div>            <div class="card-body">                {% if pending_orders %}                    {% for order in pending_orders %}                    <div class="card mb-2">                        <div class="card-body p-3">                            <div class="d-flex justify-content-between align-items-start">                                <div>                                    <h6 class="mb-1">{{ order.order_number }}</h6>                                    <p class="mb-1 small">{{ order.title|truncatechars:30 }}</p>                                    <small class="text-muted">{{ order.customer.name }}</small>                                </div>                                <div>                                    {% if order.priority == 'URGENT' %}                                        <span class="badge bg-danger">Urgente</span>                                    {% elif order.priority == 'HIGH' %}                                        <span class="badge bg-warning">Alta</span>                                    {% endif %}                                </div>                            </div>                            <div class="mt-2">                                <a href="{% url 'core:order_detail' order.pk %}" class="btn btn-sm btn-outline-primary">                                    <i class="fas fa-eye"></i> Dettagli                                </a>                            </div>                        </div>                    </div>                    {% endfor %}                {% else %}                    <div class="text-center py-3">                        <i class="fas fa-check-circle fa-2x text-success mb-2"></i>                        <p class="text-muted">Tutti gli ordini sono assegnati!</p>                    </div>                {% endif %}            </div>        </div>    </div></div><script>function refreshMap() {    // Placeholder per l'aggiornamento della mappa    console.log('Aggiornamento mappa...');    // In futuro: ricaricherà le posizioni dei tecnici}function centerMap() {    // Placeholder per centrare la mappa    console.log('Centraggio mappa...');    // In futuro: centrerà la mappa su tutti i tecnici}</script>{% endblock %}