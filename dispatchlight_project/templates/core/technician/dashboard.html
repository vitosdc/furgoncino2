<!-- templates/core/technician/dashboard.html - NUOVO FILE -->{% extends 'base.html' %}{% block title %}Dashboard Tecnico - DispatchLight{% endblock %}{% block content %}<div class="row">    <div class="col-12">        <div class="d-flex justify-content-between align-items-center mb-4">            <div>                <h1><i class="fas fa-user-cog"></i> Benvenuto, {{ technician.user.get_full_name }}</h1>                <p class="text-muted">{{ company.name }} • Dashboard Tecnico</p>            </div>            <div>                <span class="badge {% if technician.is_active %}bg-success{% else %}bg-secondary{% endif %} fs-6">                    {% if technician.is_active %}                        <i class="fas fa-circle"></i> Online                    {% else %}                        <i class="fas fa-circle"></i> Offline                    {% endif %}                </span>            </div>        </div>    </div></div><!-- Statistiche Personali --><div class="row mb-4">    <div class="col-md-3">        <div class="card card-stats text-white bg-warning">            <div class="card-body">                <div class="d-flex align-items-center">                    <div class="flex-grow-1">                        <h5 class="card-title">Ordini Assegnati</h5>                        <h2 class="mb-0">{{ pending_orders }}</h2>                    </div>                    <div class="flex-shrink-0">                        <i class="fas fa-clipboard-list fa-2x"></i>                    </div>                </div>            </div>        </div>    </div>        <div class="col-md-3">        <div class="card card-stats text-white bg-primary">            <div class="card-body">                <div class="d-flex align-items-center">                    <div class="flex-grow-1">                        <h5 class="card-title">In Lavorazione</h5>                        <h2 class="mb-0">{{ active_orders }}</h2>                    </div>                    <div class="flex-shrink-0">                        <i class="fas fa-tools fa-2x"></i>                    </div>                </div>            </div>        </div>    </div>        <div class="col-md-3">        <div class="card card-stats text-white bg-success">            <div class="card-body">                <div class="d-flex align-items-center">                    <div class="flex-grow-1">                        <h5 class="card-title">Completati Oggi</h5>                        <h2 class="mb-0">{{ today_completed }}</h2>                    </div>                    <div class="flex-shrink-0">                        <i class="fas fa-check-circle fa-2x"></i>                    </div>                </div>            </div>        </div>    </div>        <div class="col-md-3">        <div class="card card-stats text-white bg-info">            <div class="card-body">                <div class="d-flex align-items-center">                    <div class="flex-grow-1">                        <h5 class="card-title">Questa Settimana</h5>                        <h2 class="mb-0">{{ week_stats.completed }}</h2>                        <small>di {{ week_stats.total }}</small>                    </div>                    <div class="flex-shrink-0">                        <i class="fas fa-calendar-week fa-2x"></i>                    </div>                </div>            </div>        </div>    </div></div><!-- Azioni Rapide --><div class="row mb-4">    <div class="col-12">        <div class="card">            <div class="card-header">                <h5><i class="fas fa-bolt"></i> Azioni Rapide</h5>            </div>            <div class="card-body">                <div class="row">                    <div class="col-md-6 col-lg-3 mb-2">                        <a href="{% url 'core:technician_order_list' %}" class="btn btn-primary w-100">                            <i class="fas fa-list"></i> I Miei Ordini                        </a>                    </div>                    <div class="col-md-6 col-lg-3 mb-2">                        <a href="{% url 'core:technician_upcoming_orders' %}" class="btn btn-warning w-100">                            <i class="fas fa-clock"></i> Prossimi Interventi                        </a>                    </div>                    <div class="col-md-6 col-lg-3 mb-2">                        <a href="{% url 'core:technician_stats' %}" class="btn btn-info w-100">                            <i class="fas fa-chart-bar"></i> Le Mie Statistiche                        </a>                    </div>                    <div class="col-md-6 col-lg-3 mb-2">                        <a href="{% url 'core:technician_profile' %}" class="btn btn-secondary w-100">                            <i class="fas fa-user"></i> Il Mio Profilo                        </a>                    </div>                </div>            </div>        </div>    </div></div><div class="row">    <!-- Ordini Imminenti -->    <div class="col-lg-6">        <div class="card">            <div class="card-header d-flex justify-content-between align-items-center">                <h5><i class="fas fa-clock"></i> Prossimi Interventi</h5>                <a href="{% url 'core:technician_upcoming_orders' %}" class="btn btn-sm btn-outline-primary">                    Vedi Tutti                </a>            </div>            <div class="card-body">                {% if upcoming_orders %}                <div class="list-group list-group-flush">                    {% for order in upcoming_orders %}                    <div class="list-group-item">                        <div class="d-flex w-100 justify-content-between">                            <h6 class="mb-1">{{ order.title }}</h6>                            <small>{{ order.scheduled_date|date:"d/m H:i"|default:"Da programmare" }}</small>                        </div>                        <p class="mb-1">{{ order.customer.name }}</p>                        <small class="text-muted">{{ order.service_address|truncatechars:50 }}</small>                        <div class="mt-2">                            <a href="{% url 'core:technician_order_detail' order.pk %}" class="btn btn-sm btn-outline-primary">                                <i class="fas fa-eye"></i> Dettagli                            </a>                        </div>                    </div>                    {% endfor %}                </div>                {% else %}                <div class="text-center py-4">                    <i class="fas fa-calendar-check fa-3x text-muted mb-3"></i>                    <h6 class="text-muted">Nessun intervento imminente</h6>                    <p class="text-muted">Ottimo lavoro! Non hai interventi urgenti in programma.</p>                </div>                {% endif %}            </div>        </div>    </div>        <!-- Ordini Attivi -->    <div class="col-lg-6">        <div class="card">            <div class="card-header d-flex justify-content-between align-items-center">                <h5><i class="fas fa-tools"></i> Ordini Attivi</h5>                <a href="{% url 'core:technician_order_list' %}?status=ASSIGNED" class="btn btn-sm btn-outline-primary">                    Vedi Tutti                </a>            </div>            <div class="card-body">                {% if current_active_orders %}                <div class="list-group list-group-flush">                    {% for order in current_active_orders %}                    <div class="list-group-item">                        <div class="d-flex w-100 justify-content-between">                            <h6 class="mb-1">{{ order.order_number }}</h6>                            <small>                                {% if order.status == 'ASSIGNED' %}                                    <span class="badge bg-info">Assegnato</span>                                {% elif order.status == 'EN_ROUTE' %}                                    <span class="badge bg-primary">In Viaggio</span>                                {% elif order.status == 'ON_SITE' %}                                    <span class="badge bg-warning">Sul Posto</span>                                {% endif %}                            </small>                        </div>                        <p class="mb-1">{{ order.title }}</p>                        <small class="text-muted">{{ order.customer.name }} • {{ order.created_at|timesince }} fa</small>                        <div class="mt-2">                            <a href="{% url 'core:technician_order_detail' order.pk %}" class="btn btn-sm btn-outline-primary">                                <i class="fas fa-eye"></i> Dettagli                            </a>                            {% if order.status != 'ON_SITE' %}                            <a href="{% url 'core:technician_order_update' order.pk %}" class="btn btn-sm btn-outline-success">                                <i class="fas fa-edit"></i> Aggiorna                            </a>                            {% endif %}                        </div>                    </div>                    {% endfor %}                </div>                {% else %}                <div class="text-center py-4">                    <i class="fas fa-clipboard-check fa-3x text-muted mb-3"></i>                    <h6 class="text-muted">Nessun ordine attivo</h6>                    <p class="text-muted">Al momento non hai ordini in lavorazione.</p>                </div>                {% endif %}            </div>        </div>    </div></div><!-- Ultimi Ordini Completati -->{% if recent_completed %}<div class="row mt-4">    <div class="col-12">        <div class="card">            <div class="card-header">                <h5><i class="fas fa-history"></i> Ultimi Lavori Completati</h5>            </div>            <div class="card-body">                <div class="table-responsive">                    <table class="table table-sm table-hover">                        <thead>                            <tr>                                <th>Ordine</th>                                <th>Cliente</th>                                <th>Lavoro</th>                                <th>Completato</th>                                <th>Importo</th>                            </tr>                        </thead>                        <tbody>                            {% for order in recent_completed %}                            <tr>                                <td><strong>{{ order.order_number }}</strong></td>                                <td>{{ order.customer.name }}</td>                                <td>{{ order.title|truncatechars:40 }}</td>                                <td>{{ order.completed_at|date:"d/m/Y H:i" }}</td>                                <td>                                    {% if order.final_price %}                                        <strong class="text-success">€{{ order.final_price }}</strong>                                    {% else %}                                        <span class="text-muted">-</span>                                    {% endif %}                                </td>                            </tr>                            {% endfor %}                        </tbody>                    </table>                </div>            </div>        </div>    </div></div>{% endif %}{% endblock %}