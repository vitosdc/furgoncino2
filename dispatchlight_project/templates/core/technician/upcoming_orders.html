<!-- templates/core/technician/upcoming_orders.html -->{% extends 'base.html' %}{% block title %}Prossimi Interventi - DispatchLight{% endblock %}{% block content %}<div class="row">    <div class="col-12">        <div class="d-flex justify-content-between align-items-center mb-4">            <h1><i class="fas fa-clock"></i> Prossimi Interventi</h1>            <a href="{% url 'core:technician_dashboard' %}" class="btn btn-outline-secondary">                <i class="fas fa-arrow-left"></i> Dashboard            </a>        </div>    </div></div><!-- Header Info --><div class="row mb-4">    <div class="col-12">        <div class="alert alert-info">            <i class="fas fa-info-circle"></i>             <strong>{{ technician.user.get_full_name }}</strong> - Questi sono i tuoi prossimi interventi programmati.        </div>    </div></div><!-- Lista Ordini Imminenti --><div class="row">    <div class="col-12">        <div class="card">            <div class="card-header bg-warning text-dark">                <h5><i class="fas fa-calendar-alt"></i> Interventi Imminenti</h5>                <small>Ordini assegnati con scadenza nelle prossime 48 ore</small>            </div>            <div class="card-body">                {% if orders %}                    <div class="row">                        {% for order in orders %}                        <div class="col-lg-6 col-xl-4 mb-4">                            <div class="card h-100 border-left-{% if order.priority == 'URGENT' %}danger{% elif order.priority == 'HIGH' %}warning{% else %}primary{% endif %}">                                <div class="card-header d-flex justify-content-between align-items-center">                                    <strong>{{ order.order_number }}</strong>                                    {% if order.priority == 'URGENT' %}                                        <span class="badge bg-danger">Urgente</span>                                    {% elif order.priority == 'HIGH' %}                                        <span class="badge bg-warning">Alta</span>                                    {% elif order.priority == 'NORMAL' %}                                        <span class="badge bg-info">Normale</span>                                    {% else %}                                        <span class="badge bg-secondary">Bassa</span>                                    {% endif %}                                </div>                                <div class="card-body">                                    <h6 class="card-title">{{ order.title }}</h6>                                                                        <div class="mb-2">                                        <i class="fas fa-user"></i>                                        <strong>{{ order.customer.name }}</strong>                                    </div>                                                                        <div class="mb-2">                                        <i class="fas fa-phone"></i>                                        <a href="tel:{{ order.customer.phone }}">{{ order.customer.phone }}</a>                                    </div>                                                                        <div class="mb-2">                                        <i class="fas fa-map-marker-alt"></i>                                        <small>{{ order.service_address|truncatechars:50 }}</small>                                    </div>                                                                        {% if order.scheduled_date %}                                    <div class="mb-2">                                        <i class="fas fa-calendar-check"></i>                                        <strong class="text-primary">{{ order.scheduled_date|date:"d/m/Y H:i" }}</strong>                                    </div>                                    {% else %}                                    <div class="mb-2">                                        <i class="fas fa-clock"></i>                                        <span class="text-muted">Da programmare</span>                                    </div>                                    {% endif %}                                                                        {% if order.estimated_duration_minutes %}                                    <div class="mb-2">                                        <i class="fas fa-hourglass-half"></i>                                        <small class="text-muted">Durata stimata: {{ order.estimated_duration_minutes }} min</small>                                    </div>                                    {% endif %}                                                                        {% if order.description %}                                    <div class="mb-3">                                        <small class="text-muted">{{ order.description|truncatechars:100 }}</small>                                    </div>                                    {% endif %}                                                                        <div class="d-flex gap-2">                                        <a href="{% url 'core:technician_order_detail' order.pk %}" class="btn btn-sm btn-primary">                                            <i class="fas fa-eye"></i> Dettagli                                        </a>                                                                                <a href="https://maps.google.com/?q={{ order.service_address }}" target="_blank" class="btn btn-sm btn-outline-info">                                            <i class="fas fa-map"></i> Mappa                                        </a>                                                                                {% if order.status == 'ASSIGNED' %}                                        <a href="{% url 'core:technician_order_update' order.pk %}" class="btn btn-sm btn-success">                                            <i class="fas fa-play"></i> Inizia                                        </a>                                        {% endif %}                                    </div>                                </div>                                                                <div class="card-footer text-muted small">                                    Creato {{ order.created_at|timesince }} fa                                    {% if order.assigned_at %}                                        • Assegnato {{ order.assigned_at|timesince }} fa                                    {% endif %}                                </div>                            </div>                        </div>                        {% endfor %}                    </div>                                        <!-- Paginazione se necessaria -->                    {% if is_paginated %}                    <nav aria-label="Paginazione ordini">                        <ul class="pagination justify-content-center">                            {% if page_obj.has_previous %}                                <li class="page-item">                                    <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Precedente</a>                                </li>                            {% endif %}                            <li class="page-item active">                                <span class="page-link">                                    Pagina {{ page_obj.number }} di {{ page_obj.paginator.num_pages }}                                </span>                            </li>                            {% if page_obj.has_next %}                                <li class="page-item">                                    <a class="page-link" href="?page={{ page_obj.next_page_number }}">Successiva</a>                                </li>                            {% endif %}                        </ul>                    </nav>                    {% endif %}                                    {% else %}                    <div class="text-center py-5">                        <i class="fas fa-calendar-check fa-3x text-muted mb-3"></i>                        <h5 class="text-muted">Nessun intervento imminente</h5>                        <p class="text-muted">                            Non hai interventi programmati per le prossime 48 ore.<br>                            Ottimo lavoro! Puoi dedicarti ad altre attività.                        </p>                        <div class="mt-4">                            <a href="{% url 'core:technician_order_list' %}" class="btn btn-primary">                                <i class="fas fa-list"></i> Vedi Tutti i Miei Ordini                            </a>                            <a href="{% url 'core:technician_dashboard' %}" class="btn btn-outline-secondary">                                <i class="fas fa-tachometer-alt"></i> Torna alla Dashboard                            </a>                        </div>                    </div>                {% endif %}            </div>        </div>    </div></div><!-- Tips per Tecnici -->{% if orders %}<div class="row mt-4">    <div class="col-12">        <div class="card bg-light">            <div class="card-body">                <h6><i class="fas fa-lightbulb text-warning"></i> Suggerimenti per i Prossimi Interventi:</h6>                <div class="row">                    <div class="col-md-4">                        <ul class="small mb-0">                            <li>Controlla il traffico prima di partire</li>                            <li>Verifica di avere tutto l'attrezzamento necessario</li>                            <li>Chiama il cliente per confermare l'appuntamento</li>                        </ul>                    </div>                    <div class="col-md-4">                        <ul class="small mb-0">                            <li>Aggiorna lo stato "In Viaggio" quando parti</li>                            <li>Segna "Sul Posto" quando arrivi dal cliente</li>                            <li>Completa l'ordine dopo aver finito il lavoro</li>                        </ul>                    </div>                    <div class="col-md-4">                        <ul class="small mb-0">                            <li>Fotografa le ricevute per il rimborso spese</li>                            <li>Annota il materiale utilizzato</li>                            <li>Inserisci il prezzo finale prima di completare</li>                        </ul>                    </div>                </div>            </div>        </div>    </div></div>{% endif %}<style>.border-left-danger {    border-left: 4px solid #dc3545;}.border-left-warning {    border-left: 4px solid #ffc107;}.border-left-primary {    border-left: 4px solid #007bff;}.card:hover {    transform: translateY(-2px);    transition: transform 0.2s ease-in-out;    box-shadow: 0 4px 8px rgba(0,0,0,0.1);}@media (max-width: 768px) {    .card-body .d-flex {        flex-direction: column;    }    .card-body .d-flex .btn {        margin-bottom: 0.25rem;    }}</style>{% endblock %}