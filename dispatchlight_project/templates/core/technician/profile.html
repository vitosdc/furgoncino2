<!-- templates/core/technician/profile.html -->{% extends 'base.html' %}{% block title %}Il Mio Profilo Tecnico - DispatchLight{% endblock %}{% block content %}<div class="container my-4">    <div class="row">        <div class="col-12">            <div class="d-flex justify-content-between align-items-center mb-4">                <h1><i class="fas fa-id-card"></i> Il Mio Profilo Tecnico</h1>                <a href="{% url 'core:technician_dashboard' %}" class="btn btn-outline-secondary">                    <i class="fas fa-arrow-left"></i> Torna alla Dashboard                </a>            </div>        </div>    </div>    {% if technician %}    <div class="row">        <!-- Informazioni Personali -->        <div class="col-lg-6">            <div class="card mb-4">                <div class="card-header bg-primary text-white">                    <h5><i class="fas fa-user"></i> Le Mie Informazioni</h5>                </div>                <div class="card-body">                    <div class="row mb-3">                        <div class="col-sm-4"><strong>Nome Completo:</strong></div>                        <div class="col-sm-8">{{ technician.user.get_full_name }}</div>                    </div>                    <div class="row mb-3">                        <div class="col-sm-4"><strong>Username:</strong></div>                        <div class="col-sm-8">{{ technician.user.username }}</div>                    </div>                    <div class="row mb-3">                        <div class="col-sm-4"><strong>Email:</strong></div>                        <div class="col-sm-8">                            <a href="mailto:{{ technician.user.email }}">{{ technician.user.email }}</a>                        </div>                    </div>                    <div class="row mb-3">                        <div class="col-sm-4"><strong>Telefono:</strong></div>                        <div class="col-sm-8">                            <a href="tel:{{ technician.phone }}">{{ technician.phone }}</a>                        </div>                    </div>                    {% if technician.vehicle_plate %}                    <div class="row mb-3">                        <div class="col-sm-4"><strong>Veicolo:</strong></div>                        <div class="col-sm-8">                            <span class="badge bg-secondary fs-6">{{ technician.vehicle_plate }}</span>                        </div>                    </div>                    {% endif %}                    <div class="row">                        <div class="col-sm-4"><strong>Stato:</strong></div>                        <div class="col-sm-8">                            {% if technician.is_active %}                                <span class="badge bg-success">                                    <i class="fas fa-circle"></i> Attivo                                </span>                            {% else %}                                <span class="badge bg-secondary">                                    <i class="fas fa-circle"></i> Inattivo                                </span>                            {% endif %}                        </div>                    </div>                </div>            </div>        </div>        <!-- Informazioni Azienda -->        <div class="col-lg-6">            <div class="card mb-4">                <div class="card-header bg-info text-white">                    <h5><i class="fas fa-building"></i> La Mia Azienda</h5>                </div>                <div class="card-body">                    <div class="row mb-3">                        <div class="col-sm-4"><strong>Nome Azienda:</strong></div>                        <div class="col-sm-8">{{ technician.company.name }}</div>                    </div>                    <div class="row mb-3">                        <div class="col-sm-4"><strong>Telefono:</strong></div>                        <div class="col-sm-8">                            <a href="tel:{{ technician.company.phone }}">{{ technician.company.phone }}</a>                        </div>                    </div>                    <div class="row mb-3">                        <div class="col-sm-4"><strong>Email:</strong></div>                        <div class="col-sm-8">                            <a href="mailto:{{ technician.company.email }}">{{ technician.company.email }}</a>                        </div>                    </div>                    <div class="row">                        <div class="col-sm-4"><strong>Indirizzo:</strong></div>                        <div class="col-sm-8">{{ technician.company.address|linebreaksbr }}</div>                    </div>                </div>            </div>        </div>    </div>    <!-- Le Mie Statistiche -->    <div class="row">        <div class="col-12">            <div class="card">                <div class="card-header bg-success text-white">                    <h5><i class="fas fa-chart-bar"></i> Le Mie Statistiche Performance</h5>                </div>                <div class="card-body">                    <div class="row text-center">                        <div class="col-md-3">                            <div class="border-end">                                <h3 class="text-primary">{{ technician.work_orders.count }}</h3>                                <p class="text-muted mb-0">Ordini Totali</p>                            </div>                        </div>                        <div class="col-md-3">                            <div class="border-end">                                <h3 class="text-success">-</h3>                                <p class="text-muted mb-0">Completati</p>                                <small class="text-muted">Disponibile presto</small>                            </div>                        </div>                        <div class="col-md-3">                            <div class="border-end">                                <h3 class="text-warning">-</h3>                                <p class="text-muted mb-0">Attivi</p>                                <small class="text-muted">Disponibile presto</small>                            </div>                        </div>                        <div class="col-md-3">                            <h3 class="text-info">                                {% if technician.user.date_joined %}                                    {{ technician.user.date_joined|timesince }}                                {% else %}                                    N/A                                {% endif %}                            </h3>                            <p class="text-muted mb-0">Tempo di Servizio</p>                        </div>                    </div>                </div>            </div>        </div>    </div>    <!-- Posizione GPS -->    <div class="row mt-4">        <div class="col-lg-6">            <div class="card">                <div class="card-header bg-warning text-dark">                    <h5><i class="fas fa-map-marker-alt"></i> La Mia Posizione GPS</h5>                </div>                <div class="card-body">                    {% if technician.current_latitude and technician.current_longitude %}                        <div class="alert alert-success">                            <strong><i class="fas fa-check-circle"></i> GPS Attivo</strong><br>                            <small class="text-muted">                                La tua posizione è condivisa con l'ufficio per l'ottimizzazione degli interventi.                            </small>                            {% if technician.last_location_update %}                                <br><small class="text-muted">                                    <i class="fas fa-clock"></i> Ultimo aggiornamento: {{ technician.last_location_update|timesince }} fa                                </small>                            {% endif %}                        </div>                        <div class="row">                            <div class="col-6">                                <strong>Latitudine:</strong><br>                                <code>{{ technician.current_latitude|floatformat:6 }}</code>                            </div>                            <div class="col-6">                                <strong>Longitudine:</strong><br>                                <code>{{ technician.current_longitude|floatformat:6 }}</code>                            </div>                        </div>                    {% else %}                        <div class="alert alert-info">                            <strong><i class="fas fa-info-circle"></i> GPS Non Configurato</strong><br>                            <small>La tua posizione non è ancora condivisa. Questo può essere configurato dall'app mobile o dall'ufficio.</small>                        </div>                    {% endif %}                </div>            </div>        </div>        <!-- Azioni Rapide -->        <div class="col-lg-6">            <div class="card">                <div class="card-header bg-secondary text-white">                    <h5><i class="fas fa-bolt"></i> Azioni Rapide</h5>                </div>                <div class="card-body">                    <div class="d-grid gap-2">                        <a href="{% url 'core:technician_order_list' %}" class="btn btn-primary">                            <i class="fas fa-list"></i> I Miei Ordini                        </a>                        <a href="{% url 'core:technician_upcoming_orders' %}" class="btn btn-warning">                            <i class="fas fa-clock"></i> Prossimi Interventi                        </a>                        <a href="{% url 'core:technician_stats' %}" class="btn btn-info">                            <i class="fas fa-chart-line"></i> Le Mie Statistiche                        </a>                        <a href="{% url 'core:user_profile_edit' %}" class="btn btn-outline-secondary">                            <i class="fas fa-edit"></i> Modifica Profilo                        </a>                    </div>                </div>            </div>        </div>    </div>    <!-- Informazioni Account -->    <div class="row mt-4">        <div class="col-12">            <div class="card">                <div class="card-header">                    <h5><i class="fas fa-info-circle"></i> Informazioni Account</h5>                </div>                <div class="card-body">                    <div class="row">                        <div class="col-md-4">                            <h6>Accesso Account</h6>                            <ul class="list-unstyled">                                <li><strong>Registrato il:</strong> {{ technician.user.date_joined|date:"d/m/Y" }}</li>                                <li><strong>Ultimo accesso:</strong>                                     {% if technician.user.last_login %}                                        {{ technician.user.last_login|date:"d/m/Y H:i" }}                                    {% else %}                                        Mai                                    {% endif %}                                </li>                                <li><strong>Tipo Account:</strong>                                     <span class="badge bg-info">Tecnico</span>                                </li>                            </ul>                        </div>                        <div class="col-md-4">                            <h6>Dati di Contatto</h6>                            <ul class="list-unstyled">                                <li><strong>Email principale:</strong> {{ technician.user.email }}</li>                                <li><strong>Telefono lavoro:</strong> {{ technician.phone }}</li>                                {% if technician.vehicle_plate %}                                    <li><strong>Veicolo assegnato:</strong> {{ technician.vehicle_plate }}</li>                                {% endif %}                            </ul>                        </div>                        <div class="col-md-4">                            <h6>Note Importanti</h6>                            <ul class="list-unstyled small text-muted">                                <li><i class="fas fa-shield-alt"></i> I tuoi dati sono protetti</li>                                <li><i class="fas fa-map-marker-alt"></i> La posizione GPS è opzionale</li>                                <li><i class="fas fa-phone"></i> Il telefono è visibile all'ufficio</li>                                <li><i class="fas fa-edit"></i> Puoi modificare email e username</li>                            </ul>                        </div>                    </div>                </div>            </div>        </div>    </div>    {% else %}    <!-- Errore: Profilo Tecnico Non Trovato -->    <div class="row justify-content-center">        <div class="col-md-8">            <div class="card">                <div class="card-body text-center">                    <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>                    <h3>Profilo Tecnico Non Trovato</h3>                    <p class="lead">Non è stato possibile caricare il tuo profilo tecnico.</p>                    <p class="text-muted">                        Questo potrebbe indicare un problema di configurazione del tuo account.                        Contatta l'amministratore del sistema per assistenza.                    </p>                    <a href="{% url 'core:technician_dashboard' %}" class="btn btn-primary">                        <i class="fas fa-home"></i> Torna alla Dashboard                    </a>                </div>            </div>        </div>    </div>    {% endif %}</div>{% endblock %}