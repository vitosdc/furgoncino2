{% extends 'base.html' %}{% block title %}Gestione Tecnici - DispatchLight{% endblock %}{% block content %}<div class="row">    <div class="col-12">        <div class="d-flex justify-content-between align-items-center mb-4">            <h1><i class="fas fa-user-cog"></i> Gestione Tecnici</h1>            <a href="{% url 'core:technician_create' %}" class="btn btn-primary">                <i class="fas fa-user-plus"></i> Nuovo Tecnico            </a>        </div>    </div></div><div class="row">    <div class="col-12">        <div class="card">            <div class="card-body">                {% if technicians %}                <div class="table-responsive">                    <table class="table table-hover">                        <thead>                            <tr>                                <th>Nome</th>                                <th>Telefono</th>                                <th>Veicolo</th>                                <th>Stato</th>                                <th>Ultima Posizione</th>                                <th>Ordini Attivi</th>                                <th>Azioni</th>                            </tr>                        </thead>                        <tbody>                            {% for technician in technicians %}                            <tr>                                <td>                                    <strong>{{ technician.user.get_full_name }}</strong>                                    <br><small class="text-muted">{{ technician.user.username }}</small>                                </td>                                <td>                                    <a href="tel:{{ technician.phone }}" class="text-decoration-none">                                        {{ technician.phone }}                                    </a>                                </td>                                <td>                                    {% if technician.vehicle_plate %}                                        <span class="badge bg-secondary">{{ technician.vehicle_plate }}</span>                                    {% else %}                                        <span class="text-muted">Non specificato</span>                                    {% endif %}                                </td>                                <td>                                    {% if technician.is_active %}                                        <span class="badge bg-success">                                            <i class="fas fa-circle"></i> Attivo                                        </span>                                    {% else %}                                        <span class="badge bg-secondary">                                            <i class="fas fa-circle"></i> Inattivo                                        </span>                                    {% endif %}                                </td>                                <td>                                    {% if technician.last_location_update %}                                        <small class="text-muted">                                            <i class="fas fa-map-marker-alt"></i>                                            {{ technician.last_location_update|timesince }} fa                                        </small>                                    {% elif technician.current_latitude and technician.current_longitude %}                                        <small class="text-success">                                            <i class="fas fa-map-marker-alt"></i>                                            Posizione disponibile                                        </small>                                    {% else %}                                        <span class="text-muted">                                            <i class="fas fa-map-marker-alt text-muted"></i>                                            Non disponibile                                        </span>                                    {% endif %}                                </td>                                <td>                                    <span class="badge bg-info">                                        {{ technician.active_orders_count|default:0 }}                                    </span>                                    {% if technician.active_orders_count > 0 %}                                        <small class="text-muted d-block">ordini attivi</small>                                    {% endif %}                                </td>                                <td>                                    <div class="btn-group" role="group">                                        <a href="{% url 'core:technician_detail' technician.pk %}"                                            class="btn btn-sm btn-outline-primary"                                            title="Visualizza dettagli">                                            <i class="fas fa-eye"></i>                                        </a>                                        <a href="{% url 'core:technician_edit' technician.pk %}"                                            class="btn btn-sm btn-outline-warning"                                           title="Modifica tecnico">                                            <i class="fas fa-edit"></i>                                        </a>                                        <a href="{% url 'core:technician_locate' technician.pk %}"                                            class="btn btn-sm btn-outline-info"                                           title="Localizza sulla mappa">                                            <i class="fas fa-map-marker-alt"></i>                                        </a>                                    </div>                                </td>                            </tr>                            {% endfor %}                        </tbody>                    </table>                </div>                                <!-- Statistiche Riassuntive -->                <div class="row mt-4">                    <div class="col-md-3">                        <div class="card bg-light">                            <div class="card-body text-center">                                <h5 class="text-primary">{{ technicians|length }}</h5>                                <small class="text-muted">Tecnici Totali</small>                            </div>                        </div>                    </div>                    <div class="col-md-3">                        <div class="card bg-light">                            <div class="card-body text-center">                                <h5 class="text-success">                                    {% for tech in technicians %}                                        {% if tech.is_active %}{{ forloop.counter0|add:1 }}{% endif %}                                    {% empty %}0{% endfor %}                                </h5>                                <small class="text-muted">Tecnici Attivi</small>                            </div>                        </div>                    </div>                    <div class="col-md-3">                        <div class="card bg-light">                            <div class="card-body text-center">                                <h5 class="text-info">                                    {% for tech in technicians %}                                        {% if tech.current_latitude and tech.current_longitude %}{{ forloop.counter0|add:1 }}{% endif %}                                    {% empty %}0{% endfor %}                                </h5>                                <small class="text-muted">Con GPS Attivo</small>                            </div>                        </div>                    </div>                    <div class="col-md-3">                        <div class="card bg-light">                            <div class="card-body text-center">                                <h5 class="text-warning">                                    {{ technicians|length|add:"-1"|default:0 }}                                </h5>                                <small class="text-muted">Ordini Assegnati</small>                            </div>                        </div>                    </div>                </div>                                {% else %}                <div class="text-center py-5">                    <i class="fas fa-user-cog fa-3x text-muted mb-3"></i>                    <h5 class="text-muted">Nessun tecnico presente</h5>                    <p class="text-muted">Aggiungi i tuoi primi tecnici per iniziare ad assegnare ordini!</p>                    <a href="{% url 'core:technician_create' %}" class="btn btn-primary">                        <i class="fas fa-user-plus"></i> Aggiungi Primo Tecnico                    </a>                </div>                {% endif %}            </div>        </div>    </div></div>{% endblock %}